uwsgi_cache_path /var/cache/nginx/ levels=1:2 keys_zone=vesta_dynamic_cache:10m inactive=120m max_size=50m;

server {
    listen      5015;
    rewrite_log on;
    autoindex on;
    access_log /srv/vesta/logs/nginx-access.log;
    error_log /srv/vesta/logs/nginx-error.log;

    location / {
        uwsgi_cache vesta_dynamic_cache;
        uwsgi_cache_bypass $http_pragma;
        uwsgi_cache_key "$request_method|$http_if_modified_since|$http_if_none_match|$host|$request_uri";
        uwsgi_hide_header "Set-Cookie";
        uwsgi_ignore_headers "Cache-Control" "Expires" "Set-Cookie" "X-Accel-Expires";
        uwsgi_cache_use_stale error timeout invalid_header updating;
        expires 1h;
        add_header Pragma public;

	    root /srv/caesar/code/;
        include uwsgi_params;
        uwsgi_pass unix:///var/run/uwsgi/app/vesta/uwsgi.sock;
        uwsgi_buffers 8 128k;
        uwsgi_read_timeout 120;
        uwsgi_send_timeout 120;
    }
}
